<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>U.S. GDP By Year</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
  </head>
  <style>

  #chart {
    text-align: center;
    margin-top: 5em;
  }

  </style>
  <body>

    <div id="chart"></div>

    <script>

    //var url = https://raw.githubusercontent.com/FreeCodeCamp/ProjectReferenceData/master/GDP-data.json;

      var money = [];
      var dates = []
      var margin = { top: 0, right: 0, bottom: 30, left: 20 };
      var height = 400 - margin.top - margin.bottom;
      var width = 600 - margin.left - margin.right;

      var tempColor;
      var yScale;
      var xScale;
      var colors;
      var myChart;
      var yAxisValues;
      var yAxisTicks;
      var xAxisValues;
      var xAxisTicks;

       d3.json("data.json").get(function(error, d){
          for (var i = 0; i < d.data.length; i++) {
            money.push(d.data[i][1]);
            dates.push(new Date(d.data[i][0]));
          }

      //console.log(money);
      //console.log(dates);

      yScale = d3.scaleLinear()
        .domain([0, d3.max(money)])
        .range([0, height]);

      // Used for Y axis guide
      yAxisValues = d3.scaleLinear()
        .domain([0, d3.max(money)])
        .range([height, 0]);

      yAxisTicks = d3.axisLeft(yAxisValues)
        .ticks(10)

      xScale = d3.scaleBand()
        .domain(money)
        .paddingInner(.2)
        .paddingOuter(.3)
        .range([0, width]);

    // Used for X axis guide
    xAxisValues = d3.scaleTime()
      .domain([dates[0], dates[(dates.length - 1)]])
      .range([0, width])

    xAxisTicks = d3.axisBottom(xAxisValues)
      .ticks(d3.timeYear.every(10))

      colors = d3.scaleLinear()
        .domain([0, money.length * .33,
                    money.length * .66,
                    money.length
                    ])
        //.range(['#8e44ad', '#2ecc71', '#3498db', '#d35400']) Rainbow colors


      myChart =
        d3.select('#chart').append('svg')
          .attr('width', width + margin.left + margin.right)
          .attr('height', height + margin.top + margin.bottom)
          .append('g')
          .attr('transform',
                'translate(' + margin.left + ',' + margin.right + ')')

          .style('background', '#34495e')
          .selectAll('rect')
          .data(money)
          .enter().append('rect')
          // Solid green bars
          .style('fill', '#2ecc71')
          .attr('fill', function(d, i){
              return colors(i);
            })
          .attr('width', function(){
              return xScale.bandwidth();
            })
          .attr('height', 0)
          .attr('x', function(d){
              return xScale(d);
            })
          .attr('y', height)


      // Animation Effects
      .on('mouseover', function(d){
        tempColor = this.style.fill;
        d3.select(this)
          .style('fill', '#ecf0f1')
        })

      .on('mouseout', function(d){
        d3.select(this)
          .style('fill', tempColor)
        });

      // Y axis guide
      yGuide = d3.select('#chart svg').append('g')
        .attr('transform', 'translate(20,0)')
        .call(yAxisTicks)

      // X axis guide
      xGuide = d3.select('#chart svg').append('g')
        .attr('transform', 'translate(20,' + height + ')')
        .call(xAxisTicks)

      myChart.transition()
        .attr('height', function(d){
          return yScale(d);
        })
        .attr('y', function(d){
          return height - yScale(d);
        })
        .delay(function(d, i){
          return i * 20;
        })
        .duration(1000)
        .ease(d3.easeBounceOut)



  });

    </script>

  </body>
</html>
